{"ast":null,"code":"var _s = $RefreshSig$();\nimport useUser from \"./useUser\";\nimport useRefresh from \"./useRefresh\";\nimport { apiPrivate } from \"../Axios/axios\";\nconst useApiPrivate = () => {\n  _s();\n  const refresh = useRefresh();\n  const {\n    user\n  } = useUser();\n  useEffect(() => {\n    const req = apiPrivate.interceptors.request.use(config => {\n      config.headers.Authorization = `Bearer ${user}`;\n      return config;\n    }, error => {\n      return Promise.reject(error);\n    });\n    const res = apiPrivate.interceptors.response.use(response => response, async error => {\n      var _error$response;\n      const prevRequest = error === null || error === void 0 ? void 0 : error.config;\n      if ((error === null || error === void 0 ? void 0 : (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.status) === 401 || !(prevRequest !== null && prevRequest !== void 0 && prevRequest.sent)) {\n        prevRequest.sent = true;\n        const newAccess = await refresh();\n        prevRequest.headers['Authorization'] = `Bearer ${newAccess}`;\n        return apiPrivate(prevRequest);\n      }\n      return Promise.reject(error);\n    });\n    return () => {\n      apiPrivate.interceptors.response.eject(res);\n      apiPrivate.interceptors.request.eject(req);\n    };\n  }, [user, refresh]);\n  return apiPrivate;\n};\n_s(useApiPrivate, \"37skEe1OAIldcJkZtOAWSeOk7UM=\", false, function () {\n  return [useRefresh, useUser];\n});\nexport default useApiPrivate;","map":{"version":3,"names":["useUser","useRefresh","apiPrivate","useApiPrivate","_s","refresh","user","useEffect","req","interceptors","request","use","config","headers","Authorization","error","Promise","reject","res","response","_error$response","prevRequest","status","sent","newAccess","eject"],"sources":["S:/Storage/Desktop/Test/proj/client/src/Hooks/useApiPrivate.jsx"],"sourcesContent":["import useUser from \"./useUser\"\r\nimport useRefresh from \"./useRefresh\"\r\nimport { apiPrivate } from \"../Axios/axios\"\r\n\r\n\r\nconst useApiPrivate = () => {\r\n    const refresh = useRefresh()\r\n    const {user} = useUser()\r\n\r\n    useEffect(()=>{\r\n\r\n        const req = apiPrivate.interceptors.request.use((config)=>{\r\n            config.headers.Authorization = `Bearer ${user}`\r\n            return config\r\n        },(error)=>{\r\n            return Promise.reject(error)\r\n        });\r\n\r\n        const res = apiPrivate.interceptors.response.use(response=>response,\r\n            async (error)=>{\r\n                const prevRequest = error?.config;\r\n                if(error?.response?.status === 401 || !prevRequest?.sent)\r\n                {\r\n                    prevRequest.sent = true;\r\n                    const newAccess = await refresh()\r\n                    prevRequest.headers['Authorization'] = `Bearer ${newAccess}`;\r\n                    return apiPrivate(prevRequest)\r\n                }\r\n                return Promise.reject(error)\r\n            }\r\n        )\r\n\r\n        return ()=>{\r\n            apiPrivate.interceptors.response.eject(res)\r\n            apiPrivate.interceptors.request.eject(req)\r\n        }\r\n\r\n    },[user,refresh])\r\n\r\n  return apiPrivate;\r\n}\r\n\r\nexport default useApiPrivate\r\n"],"mappings":";AAAA,OAAOA,OAAO,MAAM,WAAW;AAC/B,OAAOC,UAAU,MAAM,cAAc;AACrC,SAASC,UAAU,QAAQ,gBAAgB;AAG3C,MAAMC,aAAa,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACxB,MAAMC,OAAO,GAAGJ,UAAU,CAAC,CAAC;EAC5B,MAAM;IAACK;EAAI,CAAC,GAAGN,OAAO,CAAC,CAAC;EAExBO,SAAS,CAAC,MAAI;IAEV,MAAMC,GAAG,GAAGN,UAAU,CAACO,YAAY,CAACC,OAAO,CAACC,GAAG,CAAEC,MAAM,IAAG;MACtDA,MAAM,CAACC,OAAO,CAACC,aAAa,GAAG,UAAUR,IAAI,EAAE;MAC/C,OAAOM,MAAM;IACjB,CAAC,EAAEG,KAAK,IAAG;MACP,OAAOC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;IAChC,CAAC,CAAC;IAEF,MAAMG,GAAG,GAAGhB,UAAU,CAACO,YAAY,CAACU,QAAQ,CAACR,GAAG,CAACQ,QAAQ,IAAEA,QAAQ,EAC/D,MAAOJ,KAAK,IAAG;MAAA,IAAAK,eAAA;MACX,MAAMC,WAAW,GAAGN,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAEH,MAAM;MACjC,IAAG,CAAAG,KAAK,aAALA,KAAK,wBAAAK,eAAA,GAALL,KAAK,CAAEI,QAAQ,cAAAC,eAAA,uBAAfA,eAAA,CAAiBE,MAAM,MAAK,GAAG,IAAI,EAACD,WAAW,aAAXA,WAAW,eAAXA,WAAW,CAAEE,IAAI,GACxD;QACIF,WAAW,CAACE,IAAI,GAAG,IAAI;QACvB,MAAMC,SAAS,GAAG,MAAMnB,OAAO,CAAC,CAAC;QACjCgB,WAAW,CAACR,OAAO,CAAC,eAAe,CAAC,GAAG,UAAUW,SAAS,EAAE;QAC5D,OAAOtB,UAAU,CAACmB,WAAW,CAAC;MAClC;MACA,OAAOL,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC;IAChC,CACJ,CAAC;IAED,OAAO,MAAI;MACPb,UAAU,CAACO,YAAY,CAACU,QAAQ,CAACM,KAAK,CAACP,GAAG,CAAC;MAC3ChB,UAAU,CAACO,YAAY,CAACC,OAAO,CAACe,KAAK,CAACjB,GAAG,CAAC;IAC9C,CAAC;EAEL,CAAC,EAAC,CAACF,IAAI,EAACD,OAAO,CAAC,CAAC;EAEnB,OAAOH,UAAU;AACnB,CAAC;AAAAE,EAAA,CAnCKD,aAAa;EAAA,QACCF,UAAU,EACXD,OAAO;AAAA;AAmC1B,eAAeG,aAAa","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}